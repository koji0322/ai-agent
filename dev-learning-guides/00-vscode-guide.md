# VS Code 基本操作ガイド

## 0. はじめに

このガイドは **Mac で VS Code を使い始めるための自分用リファレンス** です。

- **想定読者**: VBA（Excel VBE）は使えるが、VS Code は初めて
- **ゴール**: VS Code の基本操作を理解し、Claude Code と組み合わせて使えるようになる
- **前提**: [Claude Code 基本操作ガイド](01-claude-code-guide.md) でターミナルの基本操作は学習済み

> VBE は Excel 専用のコードエディタ。マクロを書くための環境で、Excel の中に組み込まれている。
> VS Code はあらゆる言語に対応する **汎用コードエディタ**。Python、JavaScript、HTML など何でも書ける。
> VBE が「Excel 付属の専用工具」なら、VS Code は「何にでも使える万能工具箱」。

---

## 1. インストールと初期設定

### ダウンロードとインストール

1. ブラウザで `https://code.visualstudio.com` にアクセス
2. 「Download for Mac」ボタンをクリック
3. ダウンロードされた `.zip` ファイルを開く（自動で展開される）
4. 展開された `Visual Studio Code.app` を **アプリケーション** フォルダにドラッグ
5. アプリケーションフォルダから VS Code を起動

> 初回起動時に「インターネットからダウンロードされたアプリケーションです」と警告が出たら「開く」をクリック。

### 日本語化

初期状態では英語メニューになっている。日本語化するには拡張機能を導入する。

1. VS Code を起動
2. `Cmd + Shift + X` で拡張機能パネルを開く
3. 検索欄に `Japanese Language Pack` と入力
4. 「Japanese Language Pack for Visual Studio Code」の **Install** をクリック
5. 右下に「再起動しますか？」と通知が出るので **Restart** をクリック
6. 再起動後、メニューが日本語になっていれば完了

### 初回起動時の画面

起動すると **ウェルカムタブ** が表示される。チュートリアルや最近開いたフォルダへのリンクがある。閉じても問題ない（次回以降は表示されない）。

---

## 2. 画面構成を理解する

VS Code の画面は大きく 5 つのエリアに分かれている。

```
┌──────────────────────────────────────────────┐
│ メニューバー（ファイル・編集・表示 など）         │
├───┬──────────────────────────────────────────┤
│ア │  エディタ領域                              │
│ク │ （ファイルの中身を編集する場所）              │
│テ │                                            │
│ィ │                                            │
│ビ ├──────────────────────────────────────────┤
│テ │  ターミナルパネル（下部）                    │
│ィ │ （VS Code 内蔵のターミナル）                 │
│バ │                                            │
│ー ├──────────────────────────────────────────┤
│   │  ステータスバー（最下部の細い帯）            │
└───┴──────────────────────────────────────────┘
```

※ サイドバー（エクスプローラー等）はアクティビティバーのアイコンをクリックすると、アクティビティバーとエディタ領域の間に表示される。

### 各エリアの役割

| エリア | 場所 | 役割 | VBE で例えると |
|-------|------|------|---------------|
| **アクティビティバー** | 画面の左端（アイコンが縦に並ぶ） | エクスプローラーや検索などの機能を切り替える | VBE にはない機能 |
| **サイドバー** | アクティビティバーの右隣 | ファイル一覧（エクスプローラー）や検索結果を表示 | VBE のプロジェクトエクスプローラー |
| **エディタ領域** | 画面の中央〜右 | ファイルの中身を表示・編集する | VBE のコードウィンドウ |
| **ターミナルパネル** | 画面の下部 | コマンドを実行する | VBE のイミディエイトウィンドウ（ただし本格的なターミナル） |
| **ステータスバー** | 画面の最下部（細い帯） | 言語モード・行番号・エンコーディングなどの情報 | VBE の下部ステータス表示 |

---

## 3. フォルダ（プロジェクト）を開く

VS Code では **フォルダ単位** で作業する。これが最も重要な概念のひとつ。

| VBE の場合 | VS Code の場合 |
|-----------|---------------|
| Excel ブックを開く → そのブック内のモジュールが見える | フォルダを開く → そのフォルダ内のファイルが見える |

### 操作手順

1. `Cmd + O`（またはメニュー「ファイル → フォルダーを開く...」）
2. 作業したいフォルダを選択して「開く」をクリック
3. サイドバー（エクスプローラー）にフォルダ内のファイル一覧が表示される

### 信頼の確認ダイアログ

初めて開くフォルダでは「このフォルダーの作成者を信頼しますか？」というダイアログが表示される。

- 自分で作成したフォルダ → **「はい、作成者を信頼します」** をクリック
- 信頼しないとコード実行や一部の拡張機能が制限される

> ターミナルで `mkdir` して作ったプロジェクトフォルダも、ここから開ける。
> [Claude Code 基本操作ガイド](01-claude-code-guide.md) で `cd ~/Documents/my-project` と移動していたフォルダを、VS Code で開くイメージ。

---

## 4. ファイルの編集と保存

### ファイルを開く

- サイドバー（エクスプローラー）でファイル名をクリック
- または `Cmd + P` でファイル名を検索して開く（ファイルが多いときに便利）

### 新しいファイルを作成

- サイドバーのフォルダ名にカーソルを合わせると、小さなアイコンが表示される
- 📄（新しいファイル）アイコンをクリック → ファイル名を入力して `Enter`

### 保存

| 操作 | ショートカット |
|------|-------------|
| 上書き保存 | `Cmd + S` |
| 名前を付けて保存 | `Cmd + Shift + S` |

> VBE と同じショートカット。

### 自動保存の設定

毎回 `Cmd + S` を押さなくても自動で保存されるようにできる。

1. `Cmd + ,` で設定を開く
2. 検索欄に `auto save` と入力
3. 「Files: Auto Save」を `afterDelay`（一定時間後に自動保存）に変更

### 基本的な編集ショートカット

VBE と共通のショートカットが多い。

| 操作 | ショートカット | VBE と同じ？ |
|------|-------------|-------------|
| コピー | `Cmd + C` | 同じ |
| ペースト | `Cmd + V` | 同じ |
| 切り取り | `Cmd + X` | 同じ |
| 元に戻す | `Cmd + Z` | 同じ |
| やり直し | `Cmd + Shift + Z` | VBE は `Cmd + Y` |
| 検索 | `Cmd + F` | 同じ |
| 置換 | `Cmd + H` | VBE は `Cmd + H`（同じ） |
| 全選択 | `Cmd + A` | 同じ |

---

## 5. 内蔵ターミナルの使い方

VS Code には **ターミナルが内蔵** されている。外部のターミナルアプリを別途開く必要がない。

### 開閉

```
Ctrl + `
```

（`Ctrl` キーを押しながらバッククォート `` ` `` キー。バッククォートは `Esc` キーのすぐ下にある）

### ポイント

- VS Code でフォルダを開いた状態でターミナルを開くと、**そのフォルダが作業ディレクトリになる**
- つまり `cd` で移動する手間が省ける
- [Claude Code 基本操作ガイド](01-claude-code-guide.md) で学んだコマンド（`ls`、`cd`、`pwd` など）がそのまま使える
- Claude Code の起動（`claude`）もここから実行できる

> VBE のイミディエイトウィンドウ（`Ctrl + G` で開く）は簡単なコード実行用だった。
> VS Code の内蔵ターミナルは本格的なターミナルそのもの。外部のターミナルアプリと同じことがすべてできる。

---

## 6. よく使うショートカット

### コマンドパレット（`Cmd + Shift + P`）

VS Code で最も重要なショートカット。**あらゆる機能を検索して実行できる**。

- 名前を覚えていない機能でも、キーワードで検索すれば見つかる
- 例: 「terminal」と入力 → ターミナル関連の操作が一覧表示される
- 例: 「font size」と入力 → フォントサイズの設定が表示される

> VBE にはこの機能に相当するものがない。
> 「メニューのどこにあるかわからない」ときは、まずコマンドパレットで検索する習慣をつけると効率的。

### 主要ショートカット一覧

| ショートカット | 機能 | 備考 |
|--------------|------|------|
| `Cmd + Shift + P` | コマンドパレット | 何でも検索・実行 |
| `Cmd + P` | ファイル検索 | ファイル名の一部を入力して素早く開く |
| `Cmd + ,` | 設定を開く | VS Code の各種設定を変更 |
| `Cmd + B` | サイドバーの表示/非表示 | 画面を広く使いたいとき |
| `` Ctrl + ` `` | ターミナルの表示/非表示 | 内蔵ターミナルの開閉 |
| `Cmd + Shift + X` | 拡張機能パネルを開く | 拡張機能の検索・管理 |
| `Cmd + Shift + E` | エクスプローラーを開く | ファイル一覧に戻る |
| `Cmd + /` | 行コメントの切り替え | 選択行をコメントアウト/解除 |
| `Cmd + Shift + F` | フォルダ全体を検索 | プロジェクト横断の全文検索 |

---

## 7. 拡張機能の導入

### 拡張機能とは

VS Code に機能を追加する仕組み。

> VBA でいう「アドイン」に近い概念。Excel 単体にはない機能をアドインで追加するように、VS Code も拡張機能で機能を追加できる。

### インストール方法

1. `Cmd + Shift + X` で拡張機能パネルを開く
2. 検索欄に拡張機能名を入力
3. 目的の拡張機能を見つけたら **Install** をクリック
4. 必要に応じて VS Code を再起動

### おすすめ拡張機能

| 拡張機能 | 用途 | 備考 |
|---------|------|------|
| **Japanese Language Pack** | メニューの日本語化 | 最初に入れる |
| **Claude Code** | Claude Code との連携 | VS Code 内で Claude Code を使いやすくする |
| **Python** | Python 言語サポート | Python を使う場合に必須 |
| **Pylance** | Python の高度な補完・型チェック | Python 拡張と一緒に入れる |

> 拡張機能は必要になったときに追加すればよい。最初から大量に入れる必要はない。

---

## 8. VS Code で Claude Code を使う

VS Code と Claude Code を組み合わせると、**コードの編集と AI への指示を同じ画面で行える**。

### 方法 1: 内蔵ターミナルで `claude` コマンドを実行

最もシンプルな方法。[Claude Code 基本操作ガイド](01-claude-code-guide.md) の知識がそのまま活きる。

1. VS Code でプロジェクトフォルダを開く
2. `` Ctrl + ` `` でターミナルを開く
3. `claude` と入力して `Enter`

```bash
claude
```

**利点**:
- フォルダを開いた状態でターミナルを開くので、`cd` で移動する必要がない
- Claude がファイルを編集すると、エディタ領域にリアルタイムで反映される
- [Claude Code 基本操作ガイド](01-claude-code-guide.md) で学んだスラッシュコマンドやショートカットがすべて使える

### 方法 2: Claude Code 拡張機能を使う

VS Code の拡張機能として Claude Code を使う方法。よりエディタに統合された体験ができる。

**インストール**:

1. `Cmd + Shift + X` で拡張機能パネルを開く
2. 「Claude Code」で検索
3. Anthropic 公式の拡張機能を **Install**

**基本的な使い方**:

- サイドバーに Claude Code のアイコンが追加される
- クリックすると Claude Code のチャットパネルが開く
- ターミナルで使うのと同様に、日本語で指示を入力できる

### ステータスバーの情報

Claude Code の実行中は、ステータスバー（画面最下部）にステータス情報が表示される。現在の状態（待機中・処理中など）を確認できる。

---

## 9. 便利な使い方のコツ

### ファイルをドラッグ＆ドロップで開く

Finder からファイルやフォルダを VS Code のウィンドウにドラッグ＆ドロップすると、そのまま開ける。

### 複数ファイルの同時編集（分割表示）

1. エディタ領域でファイルのタブを右にドラッグ
2. 画面が分割され、2 つのファイルを並べて表示できる
3. ショートカット: `Cmd + \` で現在のエディタを分割

> VBE でも複数のコードウィンドウを並べることはできたが、VS Code の方が柔軟。左右・上下に自由に分割できる。

### 設定の同期

VS Code の設定（拡張機能・テーマ・ショートカットなど）を GitHub アカウントや Microsoft アカウントと連携して同期できる。別の Mac でも同じ環境を再現したいときに便利。

1. 左下の歯車アイコン → 「設定の同期をオンにする」
2. GitHub または Microsoft アカウントでサインイン
3. 同期する項目を選択

---

## 10. 困ったときは

### よくある問題と対処法

| 症状 | 対処法 |
|------|--------|
| メニューが英語のまま | Japanese Language Pack をインストールして再起動。セクション 1 を参照 |
| ターミナルが開かない | `` Ctrl + ` `` を再度押す。または `Cmd + Shift + P` → 「terminal」で検索 |
| ファイルが見えない | フォルダを開いているか確認。「ファイル → フォルダーを開く」でプロジェクトフォルダを指定 |
| 拡張機能が動かない | VS Code を再起動してみる。それでもダメなら拡張機能をアンインストール → 再インストール |
| 文字化けする | ステータスバー右側のエンコーディング（UTF-8 など）をクリックして適切なエンコーディングに変更 |
| `claude` コマンドが見つからない | [Claude Code 基本操作ガイド](01-claude-code-guide.md) のセクション 2 を参照して Claude Code をインストール |

### コマンドパレットで迷ったら検索

何をしていいかわからないとき、やりたいことのキーワードを **コマンドパレット**（`Cmd + Shift + P`）に入力してみる。大抵の操作はここから見つかる。

### 公式ドキュメント

- VS Code 公式: `https://code.visualstudio.com/docs`
- 日本語の情報も多く、「VS Code + やりたいこと」で検索すると大抵の疑問は解決する
